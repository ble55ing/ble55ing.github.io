---
layout: post
title:  "VulDeePecker分析"
categories: paper
tags: paper DeepLearning
author: ble55ing
---

* content
{:toc}
## VulDeePecker分析

这是一篇用于检测程序哪里有漏洞的论文，目的在于假阴性率低，很遗憾没有给出源码。

这一项目采用了由国家标准和技术研究所 (NIST) 和软件保证参考数据集 (SARD) 放出的数据集。

## 论文关注的研究现状

最近的两款软件，VUDDY和VulPecker，假阴性率高而假阳性率低，用于检测由代码克隆引发的漏洞。而如果用于非代码克隆引起的漏洞则会出现高误报率。 

## 论文的主要工作

本文使用深度学习处理程序中的代码片段，不应由专家来手动定义特征，在不产生高假阴性率，假阳性率适当，能够判断是否有漏洞，并定位漏洞位置

VulDeePecker的效果：能够同时检测不止一种漏洞，可以结合人类知识进一步提高有效性（不是定义特征）。

## 论文要点

### 本文提出了三个指导原则

1.程序可以先转为一种中间表示，可以保留 (某些) 程序元素之间的语义关系 (例如，数据依赖和控制依赖关系)。然后再转化为向量表示输入神经。

2.程序片段粒度应当比函数小

3.由于一行代码是否包含漏洞可能取决于上下文，因此可以处理上下文的神经网络可能会更适合。

RNN有效被用于过程序分析（非漏洞检测），且会受消失梯度 (VG) 问题，同理BRNN

长期短期记忆 (LSTM) 细胞和门控轮回单元 (GRU) 细胞，由于 GRU 在语言建模上不超过 LSTM ，

本文选择了LSTM，但没有比较二者。由于LSTM是单向的，使用了双向LSTM（BLSTM）

### 关于代码片段：

直观地说，关键点的启发式概念在某种意义上可以看作是漏洞的 “中心” 或暗示漏洞存在的代码片段。对于库/API 函数使用不当造成的漏洞，调用的关键点是库/API 函数调用; 对于由于数组使用不当而导致的漏洞，关键点是数组。重要的是要注意，一种类型的漏洞可能有多种关键点。例如，缓冲区错误漏洞可能对应以下关键点: 库/API 函数调用、数组和指针。此外，在多种类型的漏洞中可能存在相同的关键点。例如，两个缓冲区错误资源管理错误漏洞可能包含库/API 函数调用的关键点。精确地定义关键点的启发式概念超出了本文的研究范围，成为未来研究的一个有趣问题; 我们专注于使用这个启发式概念作为 “镜头”，使用深度学习来学习漏洞模式。

代码片段可通过数据流或控制流分析程序生成，有一些算法和商业产品（如Checkmarx）。这些代码片段不一定是连续的代码行，而是语义上有关联的代码组成的。对每个代码片段标记是否脆弱，

### 各种相关功能的实现思路

网络的检测：给定程序，进行切片，获得代码片段，网路输出哪些片段是脆弱的，它们的下标会指引漏洞位置。

前向切片和后向切片：程序切成小片段的方法，对于一个库API函数，每个参数生成一个函数切片，然后将这些函数切片组合成代码片段，

等长输入处理：向量小于定长时，如果代码片段是从后向切片生成的，或者通过组合多个后向切片生成的，我们在向量的开头填充零; 否则，我们将零填充到向量的末尾。

向量大于定长时，如果代码片段是从后向切片生成的，或通过组合多个向后切片生成，我们删除向量的开始部分; 否则，我们删除向量的结束部分。

TP 是正确检测到漏洞的样本数，FP 是检测到错误漏洞的样本数，FN 是未检测到真正漏洞的样本数, TN 是没有漏洞未检测到的样本数。假阳性率=FP/（FP+TN）,假阴性率FNR=FN/(TP+FN)，真阳性率（召回率）TPR = TP/(TP+FN)，

 ### 总结

目前只处理C/C++程序，将来可能处理其他的。设计上只处理API相关漏洞

总的来讲，本工具使用了BLSTM，基于NIST和SARD所放出来的数据集，分类了有漏洞的代码片段和安全的代码片段，并依此来定位漏洞点，从而发现有漏洞的位置